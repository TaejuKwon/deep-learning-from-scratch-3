# **역전파 알고리즘**

수치미분 -> 계산량이 너무 많음 -> 역전파 알고리즘
gradient checking: 역전파와 수치미분의 값을 비교하는 것 (역전파는 버그가 있기 쉬움)

1. 연쇄 법칙 (Chain Rule)
   
합성함수의 미분: 구성 함수 각각을 미분한 후 곱한 것과 같다

$\frac{dy}{dx} = \frac{dy}{dy}\frac{dy}{db}\frac{db}{da}\frac{da}{dx}$

2. 역전파 원리 도출

출력에서 입력방향(역방향으로) 순서대로 계산

$\frac{dy}{dx} = \big(\big(\frac{dy}{dy}\frac{dy}{db}\big)\frac{db}{da}\big)\frac{da}{dx}$

출력(y)에서 입력 x 방향으로 곱하면서 순서대로 미분하면 최종적으로 $\frac{dy}{dx}$가 구해진다.

**전파되는 데이터들: y의 (y, a, b, x)에 대한 미분 값**

출력에서 입력으로 전파하면, 한 번의 전파만으로 모든 매개변수에 대한 미분을 계산할 수 있다.
이런 효율적인 계산 덕에 역전파를 사용하는 것.

함수 $B$는 역전파의 $B'(a)$에 대응하고, $A$는 $A'(x)$에 대응한다.
변수는 '통상값'과 '미분값'이 존재하고, 함수는 통상계산(순전파)과 미분값을 구하기 위한 계산(역전파)가 존재하는 것이라고 생각할 수 있다.

역전파 $B'(a)$를 계산하기 위해선 $a$값이 필요하다. 이는 즉, 역전파를 계산하기 위해선 순전파가 먼저 이루어져야 한다는 것이다. 
이 때 각 함수가 입력 변수의 값을 기억해두지 않으면 안된다. 그런 다음에야 각 함수의 역전파를 계산할 수 있다.
